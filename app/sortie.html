<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <!-- theme meta -->
    <meta name="theme-name" content="quixlab" />
  
    <title>Gestion du Magasin</title>
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="images/logo.png">
    <!-- Pignose Calender -->
    <link href="../plugins/pg-calendar/css/pignose.calendar.min.css" rel="stylesheet">
    <!-- Chartist -->
    <link rel="stylesheet" href="../plugins/chartist/css/chartist.min.css">
    <link rel="stylesheet" href="../plugins/chartist-plugin-tooltips/css/chartist-plugin-tooltip.css">
    <!-- Custom Stylesheet -->
    <link href="../css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">


</head>

<body>
    <div class="main-wrapper">


        <!--**********************************
            Logo start
        ***********************************-->
        <div class="nav-header">
            <div class="brand-logo">
                <a href="javascript:void(0)">
                    <!-- Logo that is always visible -->
                    <b class="logo-abbr"><img src="images/logo.png" alt="Logo" style="width: 100px; height: auto;"> </b>

                    <!-- Compact logo (logo2) that will be hidden when sidebar is collapsed -->
                    <img src="../app/images/logo2.png" alt="Compact Logo" class="logo-compact" style="max-width: 250px; height: auto; display: block;">
                </a>
            </div>
        </div>
        <!--**********************************
            Logo end
        ***********************************-->


        <!--**********************************
            Début de l'en-tête
        ***********************************-->
        <div id="navbar-placeholder"></div>
        <script src="loadNavbar.js"></script>
        <!--**********************************
            Fin de l'en-tête
        ***********************************-->




        <!--**********************************
            Sidebar start
        ***********************************-->
        <div id="sidebar-placeholder"></div>
        <script src="loadSidebar.js"></script>
        <script src="./global.js"></script>
        <!--**********************************
            Sidebar end
        ***********************************-->



<!--**********************************
    Content body start
***********************************-->
<div class="content-body">
    <div class="container-fluid">

<!-- Sortie -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h2>Gestion des Sortie</h2>
                <!-- Search and Filter Row -->
                <div class="row mb-3">
                    <!-- Action Buttons -->
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body p-3">
                                <button class="btn btn-green px-4 mr-2" data-toggle="modal" data-target="#nouvelleSortieModal">
                                    <i class="fa fa-plus-circle mr-2"></i>Ajouter Sortie
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="col-lg-5">
                        <div class="card">
                            <div class="card-body p-3">
                                <div class="d-flex align-items-center">
                                    <div class="form-group mr-2 mb-0">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text bg-primary text-white">
                                                    <i class="fa fa-calendar"></i>
                                                </span>
                                            </div>
                                            <input type="date" class="form-control" id="dateFromSortie">
                                        </div>
                                    </div>
                                    <div class="form-group mr-2 mb-0">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text bg-primary text-white">
                                                    <i class="fa fa-calendar"></i>
                                                </span>
                                            </div>
                                            <input type="date" class="form-control" id="dateToSortie">
                                        </div>
                                    </div>
                                    <button class="btn btn-light" id="clearDatesSortie">
                                        <i class="fa fa-refresh"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Search Input -->
                    <div class="col-lg-3">
                        <div class="card">
                            <div class="card-body p-3">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text bg-primary text-white">
                                            <i class="fa fa-search"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="form-control" id="searchInputSortie" placeholder="Rechercher...">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Table -->
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <!-- NSortie, Fonctionnaire, Designation, Division, Service, Prix Total, Date Aj -->
                                <th>NSortie</th>
                                <th>Fonctionnaire</th>
                                <th>Désignation</th>
                                <th>Division</th>
                                <th>Service</th>
                                <th>Prix Total</th>
                                <th>Date Aj</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Example Data Rows -->
                            <tr>
                                <td>AC1234</td>
                                <td>SOUFANE ABDELLATIF</td>
                                <td>Test test</td>
                                <td>Division A</td>
                                <td>BUREAU TRAVAUX</td>
                                <td>50,160 DH</td>
                                <td>13/01/2025</td>
                                <td>
                                    <div class="d-flex flex-wrap gap-3">
                                        <div class="d-flex w-100 gap-2">
                                            <!-- First pair -->
                                            <button type="button" class="btn btn-primary btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Modifier">
                                                <i class="fas fa-edit"></i> Modifier
                                            </button>
                                            <button type="button" class="btn btn-danger btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Supprimer">
                                                <i class="fas fa-trash-alt"></i> Supprimer
                                            </button>
                                        </div>
                                        
                                        <div class="d-flex w-100 gap-2">
                                            <!-- Second pair -->
                                            <button type="button" class="btn btn-green btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Apércu">
                                                <i class="fas fa-eye"></i> Apércu
                                            </button>
                                            <button type="button" class="btn btn-imprimer btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Imprimer">
                                                <i class="fas fa-print"></i> Imprimer
                                            </button>
                                        </div>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td>AC1234</td>
                                <td>MOHAMED ES-SLAYKI</td>
                                <td>Test test</td>
                                <td>CHEF DIVISION RECETTE</td>
                                <td>ADMINISTRATEUR</td>
                                <td>50,160 DH</td>
                                <td>13/01/2025</td>
                                <td>
                                    <div class="d-flex flex-wrap gap-3">
                                        <div class="d-flex w-100 gap-2">
                                            <!-- First pair -->
                                            <button type="button" class="btn btn-primary btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Modifier">
                                                <i class="fas fa-edit"></i> Modifier
                                            </button>
                                            <button type="button" class="btn btn-danger btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Supprimer">
                                                <i class="fas fa-trash-alt"></i> Supprimer
                                            </button>
                                        </div>
                                        
                                        <div class="d-flex w-100 gap-2">
                                            <!-- Second pair -->
                                            <button type="button" class="btn btn-green btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Apércu">
                                                <i class="fas fa-eye"></i> Apércu
                                            </button>
                                            <button type="button" class="btn btn-imprimer btn-sm pr-2 m-1 w-50" data-toggle="tooltip" data-placement="top" title="Imprimer">
                                                <i class="fas fa-print"></i> Imprimer
                                            </button>
                                        </div>
                                    </div>
                                </td>
                            </tr>


                            
                            <!-- Add more rows as needed -->
                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>


    </div>



<!-- Modal -->
<div class="modal fade" id="nouvelleSortieModal" tabindex="-1" role="dialog" aria-labelledby="nouvelleSortieModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="nouvelleSortieModalLabel">Ajouter Sortie</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="nouvelleSortieForm">
                    <div class="form-group">
                        <label for="fonctionnaire">Fonctionnaire</label>
                        <select class="form-control" id="articleFournisseur" required>
                            <option value="">Sélectionnez Fournisseur</option>
                            <option value="HATIME EZZOUBI">HATIME EZZOUBI</option>
                            <option value="ABDESSLAM IDRISSI">ABDESSLAM IDRISSI</option>
                            <option value="SAID IDRISSI BOUZIDI">SAID IDRISSI BOUZIDI</option>
                            <option value="ADIL GHAOUATI">ADIL GHAOUATI</option>
                            <option value="MOHAMED ENNASIRI">MOHAMED ENNASIRI</option>
                            <option value="YOUSSEF EL OUALI">YOUSSEF EL OUALI</option>
                            <option value="ISMAIL HAJJAJI">ISMAIL HAJJAJI</option>
                            <option value="ABDELHAK HAJJAJI">ABDELHAK HAJJAJI</option>
                            <option value="HASSAN EL GHAZOUANI">HASSAN EL GHAZOUANI</option>
                            <option value="MOHAME ATRICHA">MOHAME ATRICHA</option>
                            <option value="RACHID EDDAHMOUNI">RACHID EDDAHMOUNI</option>
                            <option value="ABDELMOUNAIM DAHMOUNI">ABDELMOUNAIM DAHMOUNI</option>
                            <option value="RADOUAN EL OUANJLI">RADOUAN EL OUANJLI</option>
                            <option value="RACHID BAKKOURI">RACHID BAKKOURI</option>
                            <option value="TAOUFIK BAJJOU">TAOUFIK BAJJOU</option>
                            <option value="JAMAL EL ABBAI">JAMAL EL ABBAI</option>
                            <option value="HASSAN KALLOUBI">HASSAN KALLOUBI</option>
                            <option value="FOUAD MANSOUR">FOUAD MANSOUR</option>
                            <option value="HICHAM TRITAH">HICHAM TRITAH</option>
                            <option value="ABDELLAH IDRISSI BOUZAII">ABDELLAH IDRISSI BOUZAII</option>
                            <option value="MOHAMED ERRAHOUTI">MOHAMED ERRAHOUTI</option>
                            <option value="TAOUFIK ELBRANSI">TAOUFIK ELBRANSI</option>
                            <option value="ABDELLALI OTMANI">ABDELLALI OTMANI</option>
                            <option value="ABDELHAFID EL BOUZAII">ABDELHAFID EL BOUZAII</option>
                            <option value="MOSTAPHA LYOUBI">MOSTAPHA LYOUBI</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="designation">Motif</label>
                        <textarea class="form-control" id="designation" name="designation" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="division">Division</label>
                        <select class="form-control" id="division" name="division">
                            <option value="division1">Division de Travaux et Construction</option>
                            <option value="division2">Division des Ressources Humaines</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="service">Service</label>
                        <select class="form-control" id="service" name="service">
                            <option value="service1">Service de Supervision de Chantier</option>
                            <option value="service2">Service de Planification et d'Études Techniques</option>
                            <option value="service3">Service de Formation et Développement</option>
                            <option value="service4">Service de Paie et Avantages Sociaux</option>
                            <option value="service5">Service d’Évaluation et de Performance</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="article">Articles</label>
                        <div id="articles-container">
                            <div class="article-item d-flex align-items-center mb-2">
                                <select class="form-control selectpicker article-select mr-2" name="article[]" data-live-search="true">
                                    <option value="boite_archive_6cm">BOITE ARCHIVE EN PLASTIQUE 6cm</option>
                                    <option value="boite_archive_4cm">BOITE ARCHIVE EN PLASTIQUE 4cm</option>
                                    <option value="chemise_bulle_jaune">Chemise à bulle jaune</option>
                                    <option value="chemise_arabas">Chemise en arabas</option>
                                    <option value="chemise_sangle">Chemise à sangle</option>
                                    <option value="chemise_cartonnee">Chemise cartonnée</option>
                                    <option value="correcteur_forme_stylo">Correcteur forme de stylo</option>
                                    <option value="encre_konica">Encre de photocopieur Konica minolta</option>
                                    <option value="encre_ricoh">Encre de photocopieur Ricoh Aficio MP 2000</option>
                                    <option value="caches_composteurs">Les caches composteurs</option>
                                </select>
                                <input type="number" class="form-control article-quantity" name="quantity[]" min="1" placeholder="Quantité" style="width: 80px;">
                                <button type="button" class="btn btn-danger btn-sm remove-article ml-2">X</button>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary btn-sm mt-2" id="add-article">Ajouter un autre article</button>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <div class="d-flex justify-content-between w-100">
                    <div>
                        <button type="submit" class="btn btn-green">Ajouter Sortie</button>
                        <button type="button" class="btn btn-warning" id="print-invoice">Imprimer Facture</button>
                    </div>
                    <div>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('add-article').addEventListener('click', function() {
        const container = document.getElementById('articles-container');
        const newArticle = `
            <div class="article-item d-flex align-items-center mb-2">
                <select class="form-control selectpicker article-select mr-2" name="article[]" data-live-search="true">
                    <option value="boite_archive_6cm">BOITE ARCHIVE EN PLASTIQUE 6cm</option>
                    <option value="boite_archive_4cm">BOITE ARCHIVE EN PLASTIQUE 4cm</option>
                    <option value="chemise_bulle_jaune">Chemise à bulle jaune</option>
                    <option value="chemise_arabas">Chemise en arabas</option>
                    <option value="chemise_sangle">Chemise à sangle</option>
                    <option value="chemise_cartonnee">Chemise cartonnée</option>
                    <option value="correcteur_forme_stylo">Correcteur forme de stylo</option>
                    <option value="encre_konica">Encre de photocopieur Konica minolta</option>
                    <option value="encre_ricoh">Encre de photocopieur Ricoh Aficio MP 2000</option>
                    <option value="caches_composteurs">Les caches composteurs</option>
                </select>
                <input type="number" class="form-control article-quantity" name="quantity[]" min="1" placeholder="Quantité" style="width: 80px;">
                <button type="button" class="btn btn-danger btn-sm remove-article ml-2">X</button>
            </div>`;
        container.insertAdjacentHTML('beforeend', newArticle);
    });

    document.getElementById('articles-container').addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-article')) {
            e.target.closest('.article-item').remove();
        }
    });

    document.getElementById('print-invoice').addEventListener('click', function() {
        alert('Facture imprimée !');
        // Implémentation réelle pour l'impression
    });
</script>




<!-- Apércu Modal -->
<!-- Display-> [NBL,Partenaire,Désignation,Date d'Ajoutée,Prix Total,PTTC] -->

<!-- Supprimer Modal -->


<!-- Imprimer Modal -->


<!-- Modifier Modal -->

</div>
<!--**********************************
    Content body end
***********************************-->

<!-- JavaScript for Dynamic Price Calculation -->
<script>
    document.getElementById('addProductBtn').addEventListener('click', function () {
        const productList = document.getElementById('productList');
        const selectedProducts = document.getElementById('selectedProducts');
        const prixTotalInput = document.getElementById('prixTotal');
        let total = 0;

        Array.from(productList.selectedOptions).forEach(option => {
            const productId = option.value;

            // Check if product is already added
            if (!document.querySelector(`.product-item[data-product-id="${productId}"]`)) {
                const productItem = document.createElement('div');
                productItem.classList.add('product-item', 'mb-2');
                productItem.setAttribute('data-product-id', productId);

                const price = Math.floor(Math.random() * 1000) + 100; // Example random price
                total += price;

                productItem.innerHTML = `
                    <span>${option.text}</span> 
                    <input type="number" class="form-control w-25 d-inline ms-2" placeholder="Quantité">
                    <input type="number" class="form-control w-25 d-inline ms-2" placeholder="Prix">
                    <input type="text" class="form-control w-25 d-inline ms-2" placeholder="TVA">
                    <button class="btn btn-sm btn-danger ms-2 remove-product">Supprimer</button>
                `;

                selectedProducts.appendChild(productItem);
            }
        });

        prixTotalInput.value = total + " DH";

        // Remove product event
        selectedProducts.addEventListener('click', function (e) {
            if (e.target.classList.contains('remove-product')) {
                const productPrice = parseInt(e.target.previousElementSibling.textContent.split(' ')[0]);
                total -= productPrice;
                prixTotalInput.value = total + " DH";
                e.target.closest('.product-item').remove();
            }
        });
    });
</script>



        <!--**********************************
            Footer start
        ***********************************-->
        <div class="footer">
            <div class="copyright">
                <p>Gestion du Magasin 2025</p>
            </div>
        </div>
        <!--**********************************
            Footer end
        ***********************************-->
    </div>

    <!--**********************************
        Scripts
    ***********************************-->
    <script src="../plugins/common/common.min.js"></script>
    <script src="../js/custom.min.js"></script>
    <script src="../js/settings.js"></script>
    <script src="../js/gleek.js"></script>
    <script src="../js/styleSwitcher.js"></script>
</body>

</html>